Summary: NethServer CUPS module
Name: nethserver-cups
Version:        @@VERSION@@
Release:        @@RELEASE@@
License: GPL
Group: Networking/Daemons
Source0: %{name}-%{version}.tar.gz
Packager: Giacomo Sanchietti <giacomo@nethesis.it>

#Requires: cups-pdf
BuildArch: noarch

Requires: foomatic, ghostscript, hpijs
Requires: nethserver-base

BuildRequires: nethserver-devtools
AutoReq: no

%description
CUPS module for NethServer.

Based on a work of Robert van den Aker <robert2@dds.nl>

%prep
%setup -q

%build
perl createlinks
mkdir -p root/usr/lib/cups/backend && ln -s /usr/bin/smbspool root/usr/lib/cups/backend/smb

%install
rm -rf $RPM_BUILD_ROOT
(cd root ; find . -depth -print | cpio -dump $RPM_BUILD_ROOT)
rm -f %{name}-%{version}-%{release}-filelist
/sbin/e-smith/genfilelist $RPM_BUILD_ROOT \
    --file /home/e-smith/db/cups "config(noreplace) %attr(0640,root,admin)" \
    > %{name}-%{version}-%{release}-filelist
echo "%doc COPYING" >> %{name}-%{version}-%{release}-filelist


%post
source /etc/nethserver/rpm_hook_functions
event_queue add %{name}-update

%preun
source /etc/nethserver/rpm_hook_functions
signal-event  %{name}-uninstall $1

%clean
rm -rf $RPM_BUILD_ROOT

%files -f %{name}-%{version}-%{release}-filelist
%defattr(-,root,root)

%changelog
* Wed Jan 16 2013 Giacomo Sanchietti <giacomo.sanchietti@gmail.com> 1.0.0-1
- First release
